# Project Forest - 機能テスト手順書

## 概要

本ドキュメントは、Project Forest の各機能が要件通りに動作することを確認するためのテスト手順書です。開発者・テスター・品質保証担当者が機能検証を行う際の統一的な手順を提供します。

## テスト環境セットアップ

### 前提条件

- ローカル環境が正常に構築されている（LOCAL_VERIFICATION.md参照）
- テスト用データベースが準備されている
- 必要なテストデータが投入されている

### テストデータ準備

```sql
-- テスト用データの投入
INSERT INTO characters (name, first_person, second_person, description) VALUES
('テストキャラクター1', '私', 'あなた', 'テスト用キャラクター'),
('テストキャラクター2', '俺', 'お前', 'テスト用キャラクター2');

INSERT INTO tags (name, display_text, icon, description) VALUES
('test_tag', '{TEST_TAG}', '🧪', 'テスト用タグ');

INSERT INTO proper_nouns (term, reading, english, category, description) VALUES
('テスト王国', 'てすとおうこく', 'Test Kingdom', '地名', 'テスト用固有名詞');

INSERT INTO forbidden_words (word, replacement, category, reason) VALUES
('テスト禁止語', 'テスト代替語', 'その他', 'テスト用禁止語');
```

## テスト記録シート

### テスト結果記録

各テストケースの実行結果を以下の形式で記録してください：

| 項目 | 記号 | 意味 |
|------|------|------|
| ✅ | PASS | テスト成功 |
| ❌ | FAIL | テスト失敗 |
| ⚠️ | WARNING | 部分的な問題あり |
| 🔄 | PENDING | テスト未実施 |

## 1. 基盤機能テスト

### 1.1 システム起動テスト

#### TC-001: アプリケーション起動
```
目的: システムが正常に起動することを確認
前提条件: 開発環境がセットアップ済み
手順:
1. npm run dev コマンドを実行
2. http://localhost:3000 にアクセス
3. 管理画面にリダイレクトされることを確認

期待結果:
- エラーなくサーバーが起動する
- 管理画面が表示される
- コンソールにエラーが出力されない

テスト結果: 🔄
```

#### TC-002: データベース接続テスト
```
目的: データベース接続が正常に動作することを確認
手順:
1. /api/health/db にアクセス
2. レスポンスを確認

期待結果:
- ステータス200でレスポンスが返る
- {"status":"ok","database":"connected"} が返る

テスト結果: 🔄
```

### 1.2 認証・セッション管理テスト

#### TC-003: セッション管理
```
目的: セッション管理が正常に動作することを確認
手順:
1. 管理画面にアクセス
2. 長時間（30分）操作せずに待機
3. 操作を再開する

期待結果:
- セッションタイムアウトが適切に処理される
- 再認証が必要な場合は適切に誘導される

テスト結果: 🔄
```

## 2. キャラクター設定機能テスト

### 2.1 基本CRUD操作テスト

#### TC-101: キャラクター新規作成
```
目的: 新しいキャラクターが正常に作成できることを確認
手順:
1. 「キャラクター設定」タブをクリック
2. 「新規追加」ボタンをクリック
3. 以下の情報を入力:
   - キャラクター名: 自動テストキャラクター
   - 一人称: 僕
   - 二人称: 君
   - 説明: 自動テスト用のキャラクター
4. 「登録」ボタンをクリック

期待結果:
- モーダルが正常に開く
- 入力フィールドが全て機能する
- 保存後にキャラクター一覧に表示される
- 成功メッセージが表示される

テスト結果: 🔄
```

#### TC-102: キャラクター編集
```
目的: 既存キャラクターの編集が正常に動作することを確認
手順:
1. 既存キャラクターの「編集」ボタンをクリック
2. キャラクター名を「編集済みキャラクター」に変更
3. 「更新」ボタンをクリック

期待結果:
- 編集モーダルが開く
- 既存データが正しく表示される
- 更新後に変更が反映される

テスト結果: 🔄
```

#### TC-103: キャラクター削除
```
目的: キャラクターの削除が正常に動作することを確認
手順:
1. テスト用キャラクターの「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

期待結果:
- 確認ダイアログが表示される
- 削除後に一覧から該当キャラクターが除外される

テスト結果: 🔄
```

### 2.2 バリデーションテスト

#### TC-104: 必須項目チェック
```
目的: 必須項目のバリデーションが正常に動作することを確認
手順:
1. 「新規追加」ボタンをクリック
2. キャラクター名を空にして「登録」をクリック

期待結果:
- エラーメッセージが表示される
- 保存処理が中断される
- 必須項目がハイライトされる

テスト結果: 🔄
```

#### TC-105: 文字数制限チェック
```
目的: 文字数制限のバリデーションが正常に動作することを確認
手順:
1. キャラクター名に101文字の文字列を入力
2. 「登録」をクリック

期待結果:
- 文字数制限エラーが表示される
- 保存処理が中断される

テスト結果: 🔄
```

### 2.3 検索機能テスト

#### TC-106: リアルタイム検索
```
目的: キャラクター検索機能が正常に動作することを確認
手順:
1. 検索ボックスに「主人公」と入力
2. 検索結果を確認
3. 検索ボックスをクリアして全件表示に戻る

期待結果:
- 入力と同時に検索結果が更新される
- 部分一致検索が機能する
- 検索クリア後に全件表示される

テスト結果: 🔄
```

## 3. タグ管理機能テスト

### 3.1 タグCRUD操作テスト

#### TC-201: タグ新規作成
```
目的: 新しいタグが正常に作成できることを確認
手順:
1. 「タグ管理」タブをクリック
2. 「新規タグ追加」ボタンをクリック
3. 以下の情報を入力:
   - タグ名: auto_test_tag
   - 表示テキスト: {AUTO_TEST_TAG}
   - アイコン: 🤖
   - 説明: 自動テスト用タグ
4. 「登録」ボタンをクリック

期待結果:
- タグが正常に作成される
- 一覧に新しいタグが表示される
- アイコンが正しく表示される

テスト結果: 🔄
```

#### TC-202: タグ名フォーマット検証
```
目的: タグ名の形式チェックが正常に動作することを確認
手順:
1. 「新規タグ追加」ボタンをクリック
2. タグ名に「無効な-タグ名」を入力
3. 「登録」をクリック

期待結果:
- フォーマットエラーが表示される
- 英数字とアンダースコアのみが許可される

テスト結果: 🔄
```

### 3.2 タグ検索機能テスト

#### TC-203: タグ使用箇所検索
```
目的: タグの使用箇所検索機能が正常に動作することを確認
手順:
1. 既存タグの「検索」ボタンをクリック
2. 検索結果を確認

期待結果:
- 検索処理が実行される
- 適切なメッセージまたは結果が表示される

テスト結果: 🔄
```

## 4. 固有名詞管理機能テスト

### 4.1 固有名詞CRUD操作テスト

#### TC-301: 固有名詞新規作成
```
目的: 新しい固有名詞が正常に作成できることを確認
手順:
1. 「固有名詞管理」タブをクリック
2. 「新規追加」ボタンをクリック
3. 以下の情報を入力:
   - 固有名詞: 自動テスト城
   - 読み方: じどうてすとじょう
   - 英語表記: Auto Test Castle
   - カテゴリ: 地名
   - 説明: 自動テスト用の城
4. 「登録」ボタンをクリック

期待結果:
- 固有名詞が正常に作成される
- 一覧に新しい固有名詞が表示される
- カテゴリフィルターで正しく分類される

テスト結果: 🔄
```

### 4.2 フィルタリング機能テスト

#### TC-302: カテゴリフィルター
```
目的: カテゴリフィルター機能が正常に動作することを確認
手順:
1. カテゴリフィルターで「地名」を選択
2. 結果を確認
3. 「全て」を選択して全件表示に戻る

期待結果:
- 地名カテゴリのみが表示される
- フィルタークリア後に全件表示される

テスト結果: 🔄
```

#### TC-303: 複合条件検索
```
目的: 検索とフィルターの複合条件が正常に動作することを確認
手順:
1. 検索ボックスに「エルデン」を入力
2. カテゴリフィルターで「アイテム・道具」を選択
3. 結果を確認

期待結果:
- 両方の条件を満たすデータのみが表示される
- 検索条件が正確に適用される

テスト結果: 🔄
```

### 4.3 統計情報テスト

#### TC-304: 統計情報表示
```
目的: 統計情報が正確に表示されることを確認
手順:
1. 固有名詞管理画面を開く
2. 統計情報を確認
3. 新しい固有名詞を追加
4. 統計情報の更新を確認

期待結果:
- 登録済み数が正確に表示される
- データ追加後に統計が更新される

テスト結果: 🔄
```

## 5. 禁止用語管理機能テスト

### 5.1 禁止用語CRUD操作テスト

#### TC-401: 禁止用語新規作成
```
目的: 新しい禁止用語が正常に作成できることを確認
手順:
1. 「禁止用語管理」タブをクリック
2. 「新規追加」ボタンをクリック
3. 以下の情報を入力:
   - 禁止用語: 自動テスト語
   - 置換語: 自動代替語
   - カテゴリ: その他
   - 理由: 自動テスト用
4. 「登録」ボタンをクリック

期待結果:
- 禁止用語が正常に作成される
- 一覧に新しい禁止用語が表示される
- カテゴリ別の色分けが正しく表示される

テスト結果: 🔄
```

### 5.2 検出機能テスト

#### TC-402: 全文スキャン機能
```
目的: 禁止用語の全文スキャン機能が正常に動作することを確認
手順:
1. 「全テキストスキャン」ボタンをクリック
2. 処理結果を確認

期待結果:
- スキャン処理が実行される
- 適切なメッセージが表示される
- 検出結果が表示される（該当がある場合）

テスト結果: 🔄
```

### 5.3 一括処理テスト

#### TC-403: 一括置換機能
```
目的: 一括置換機能が正常に動作することを確認
手順:
1. 検出された禁止用語がある場合
2. 「一括置換」ボタンをクリック
3. 置換処理を実行

期待結果:
- 一括置換処理が実行される
- 処理結果が正確に表示される

テスト結果: 🔄
```

## 6. スタイル設定機能テスト

### 6.1 スタイルCRUD操作テスト

#### TC-501: スタイル新規作成
```
目的: 新しいスタイルが正常に作成できることを確認
手順:
1. 「スタイル設定」タブをクリック
2. 「新規スタイル追加」ボタンをクリック
3. 以下の設定を入力:
   - スタイル名: 自動テストスタイル
   - フォント: Noto Sans JP
   - 最大文字数: 25
   - 最大行数: 3
   - フォントサイズ: 14
4. 「作成」ボタンをクリック

期待結果:
- スタイルが正常に作成される
- 一覧に新しいスタイルが表示される
- プレビューが正しく表示される

テスト結果: 🔄
```

### 6.2 プレビュー機能テスト

#### TC-502: リアルタイムプレビュー
```
目的: プレビュー機能が正常に動作することを確認
手順:
1. スタイル作成モーダルを開く
2. 各設定値を変更
3. プレビューの更新を確認

期待結果:
- 設定変更がリアルタイムでプレビューに反映される
- 文字数・行数制限が正確に表示される

テスト結果: 🔄
```

### 6.3 スタイル操作テスト

#### TC-503: スタイル複製
```
目的: スタイル複製機能が正常に動作することを確認
手順:
1. 既存スタイルの「複製」ボタンをクリック
2. 複製されたスタイルを確認

期待結果:
- 複製されたスタイルが作成される
- 元のスタイル設定が正確にコピーされる
- 名前が適切に変更される

テスト結果: 🔄
```

## 7. UI/UX機能テスト

### 7.1 レスポンシブデザインテスト

#### TC-601: モバイル表示
```
目的: モバイル端末での表示が正常であることを確認
手順:
1. Chrome DevToolsでモバイル表示に切り替え
2. 各機能の動作を確認
3. タッチ操作をシミュレート

期待結果:
- レイアウトが適切に調整される
- ボタンがタッチしやすいサイズ
- モーダルが画面に収まる

テスト結果: 🔄
```

#### TC-602: タブレット表示
```
目的: タブレット端末での表示が正常であることを確認
手順:
1. Chrome DevToolsでタブレット表示に切り替え
2. 横向き・縦向きでの表示を確認

期待結果:
- 中間サイズでのレイアウトが適切
- 両方向での表示が正常

テスト結果: 🔄
```

### 7.2 アクセシビリティテスト

#### TC-603: キーボードナビゲーション
```
目的: キーボードのみでの操作が可能であることを確認
手順:
1. マウスを使わずにTabキーで要素を移動
2. Enterキーでボタンを実行
3. Escキーでモーダルを閉じる

期待結果:
- 全ての操作要素にフォーカス可能
- 論理的なタブ順序
- キーボードショートカットが機能

テスト結果: 🔄
```

## 8. パフォーマンステスト

### 8.1 レスポンス時間テスト

#### TC-701: ページ読み込み時間
```
目的: ページの読み込み時間が許容範囲内であることを確認
手順:
1. Chrome DevToolsのNetworkタブを開く
2. 各画面への遷移時間を測定
3. APIレスポンス時間を確認

期待結果:
- 初回読み込み: 3秒以内
- 2回目以降: 1秒以内
- APIレスポンス: 500ms以内

測定結果:
- 管理画面トップ: ___ms
- キャラクター管理: ___ms
- タグ管理: ___ms

テスト結果: 🔄
```

### 8.2 大量データ処理テスト

#### TC-702: 大量データ表示
```
目的: 大量データでも正常に動作することを確認
前提条件: 1000件以上のテストデータが投入済み
手順:
1. 各管理画面で大量データを表示
2. 検索・フィルタリング機能を実行
3. パフォーマンスを測定

期待結果:
- 1000件以上のデータでも正常動作
- ページネーション機能が正常
- 検索・フィルタが高速

テスト結果: 🔄
```

## 9. セキュリティテスト

### 9.1 入力検証テスト

#### TC-801: XSS対策
```
目的: XSS攻撃に対する防御が有効であることを確認
手順:
1. 入力フィールドに以下を入力:
   <script>alert('XSS')</script>
2. 保存・表示して動作確認

期待結果:
- スクリプトが実行されない
- HTMLエスケープが正常に動作
- サニタイゼーション機能が有効

テスト結果: 🔄
```

#### TC-802: SQLインジェクション対策
```
目的: SQLインジェクション攻撃に対する防御が有効であることを確認
手順:
1. 検索フィールドに以下を入力:
   ' OR '1'='1
2. データベースクエリの動作確認

期待結果:
- 不正なクエリが実行されない
- パラメータ化クエリが使用されている
- エラーが適切にハンドリングされる

テスト結果: 🔄
```

### 9.2 権限テスト

#### TC-803: 権限制御
```
目的: ユーザー権限に応じたアクセス制御が正常に動作することを確認
手順:
1. 異なる権限レベルのユーザーでログイン
2. 各機能へのアクセスを確認
3. 権限外操作の制限を確認

期待結果:
- 権限に応じて機能が制限される
- 不正アクセスが適切にブロックされる

テスト結果: 🔄
```

## 10. 統合テスト

### 10.1 ワークフローテスト

#### TC-901: 完全ワークフローテスト
```
目的: 一連のワークフローが正常に動作することを確認
手順:
1. キャラクターを新規作成
2. 関連するタグを作成
3. 固有名詞を登録
4. 禁止用語チェックを実行
5. スタイルを適用
6. 全体の整合性を確認

期待結果:
- 各機能が連携して正常に動作する
- データの整合性が保たれる
- ワークフローが途切れない

テスト結果: 🔄
```

### 10.2 データ整合性テスト

#### TC-902: 参照整合性
```
目的: データベースの参照整合性が保たれることを確認
手順:
1. 関連データを作成
2. 参照元データの削除を試行
3. 整合性制約の動作を確認

期待結果:
- 外部キー制約が正常に動作する
- 不正なデータ削除が防止される
- 適切なエラーメッセージが表示される

テスト結果: 🔄
```

## 11. 回帰テスト

### 11.1 既存機能影響確認

#### TC-1001: 既存機能回帰テスト
```
目的: 新機能追加により既存機能に影響がないことを確認
手順:
1. 主要機能の基本動作を確認
2. 以前のテストケースを再実行
3. 動作の差異を確認

期待結果:
- 既存機能に影響がない
- パフォーマンスが劣化していない
- データ整合性が保たれている

テスト結果: 🔄
```

## 12. 負荷テスト

### 12.1 同時アクセステスト

#### TC-1101: 同時接続テスト
```
目的: 複数ユーザーの同時アクセスが正常に処理されることを確認
手順:
1. 複数ブラウザ・タブで同時アクセス
2. 同時データ操作を実行
3. 競合状態の処理を確認

期待結果:
- 同時接続が適切に処理される
- データ競合が正しく解決される
- システムが安定して動作する

テスト結果: 🔄
```

## 13. ブラウザ互換性テスト

### 13.1 クロスブラウザテスト

#### TC-1201: Chrome互換性
```
目的: Google Chromeでの完全な動作を確認
期待結果: 全機能が正常に動作する
テスト結果: 🔄
```

#### TC-1202: Firefox互換性
```
目的: Mozilla Firefoxでの動作を確認
期待結果: 全機能が正常に動作する
テスト結果: 🔄
```

#### TC-1203: Edge互換性
```
目的: Microsoft Edgeでの動作を確認
期待結果: 全機能が正常に動作する
テスト結果: 🔄
```

#### TC-1204: Safari互換性
```
目的: Safariでの基本動作を確認
期待結果: 基本機能が動作する（一部制限あり）
テスト結果: 🔄
```

## 14. バックアップ・復旧テスト

### 14.1 データバックアップテスト

#### TC-1301: データバックアップ
```
目的: データバックアップ機能が正常に動作することを確認
手順:
1. 現在のデータをバックアップ
2. バックアップファイルの内容を確認
3. データの完全性を検証

期待結果:
- 全データが正常にバックアップされる
- バックアップファイルが破損していない

テスト結果: 🔄
```

#### TC-1302: データ復旧
```
目的: データ復旧機能が正常に動作することを確認
手順:
1. テストデータを削除
2. バックアップからデータを復旧
3. 復旧後のデータを確認

期待結果:
- データが正常に復旧される
- 参照整合性が保たれる

テスト結果: 🔄
```

## 15. テスト結果集計

### 15.1 テスト実行サマリー

```
実行日時: _______________
テスト実行者: ___________
環境: __________________

テスト結果統計:
- 総テストケース数: 50
- 実行済み: ___
- 成功: ___
- 失敗: ___
- 警告: ___
- 未実施: ___

合格率: ___%
```

### 15.2 課題・問題点

```
発見された問題:
1. [TC-XXX] 問題の詳細
   - 現象:
   - 再現手順:
   - 期待動作:
   - 実際の動作:
   - 重要度: 高/中/低
   - 対応状況:

2. [TC-XXX] 問題の詳細
   - 現象:
   - 再現手順:
   - 期待動作:
   - 実際の動作:
   - 重要度: 高/中/低
   - 対応状況:
```

### 15.3 改善提案

```
機能改善提案:
1. UI/UX改善
   - 提案内容:
   - 期待効果:
   - 実装優先度:

2. パフォーマンス改善
   - 提案内容:
   - 期待効果:
   - 実装優先度:

3. 機能追加
   - 提案内容:
   - 期待効果:
   - 実装優先度:
```

## 16. 承認・リリース判定

### 16.1 リリース判定基準

```
リリース可能な条件:
□ 全ての高優先度テストが成功
□ 中優先度テストの成功率が90%以上
□ 致命的なバグが存在しない
□ パフォーマンスが基準を満たす
□ セキュリティテストが全て成功
□ ブラウザ互換性テストが基準を満たす

リリース判定: 可/不可
判定理由: _________________
```

### 16.2 承認記録

```
テスト責任者承認:
署名: _________________ 日付: _______

品質保証責任者承認:
署名: _________________ 日付: _______

プロジェクトマネージャー承認:
署名: _________________ 日付: _______
```

## 付録

### A. テスト環境構築手順

詳細な環境構築手順については、LOCAL_VERIFICATION.md を参照してください。

### B. 自動テストスクリプト

```bash
# 基本的なAPIテスト
npm run test:api

# フロントエンドユニットテスト
npm run test:unit

# 統合テスト
npm run test:integration

# 全テスト実行
npm run test:all
```

### C. パフォーマンス測定ツール

```bash
# Lighthouseでのパフォーマンス測定
lighthouse http://localhost:3000/admin --output json --output-path ./lighthouse-report.json

# 負荷テスト
ab -n 1000 -c 10 http://localhost:3000/admin
```

### D. セキュリティテストツール

```bash
# 脆弱性スキャン
npm audit

# セキュリティテスト
npm run test:security
```

---

**最終更新**: 2024年1月  
**バージョン**: 1.0.0  
**作成者**: Project Forest 開発チーム